name: Documentación Automática

on:
  issues:
    types: [opened, closed, edited, labeled, unlabeled]
  pull_request:
    types: [opened, closed, edited, labeled, unlabeled, merged]
  milestone:
    types: [created, closed, edited, opened]
  workflow_dispatch:

jobs:
  docgen:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Instalar dependencias
        run: pip install pyyaml requests
      - name: Obtener datos de GitHub
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GITHUB_REPOSITORY: ${{ github.repository }}
        run: python scripts/fetch_github_data.py
      - name: Generar documentación para Pages
        run: python scripts/generate_docs.py
      - name: Generar documentación para Wiki
        run: python scripts/generate_wiki.py
      - name: Subir archivos a la Wiki (EndBug)
        uses: EndBug/add-and-commit@v9
        with:
          add: 'wiki/*'
          message: 'docs(wiki): actualización automática de la Wiki'
          cwd: wiki
          author_name: LucioManittaMa
          author_email: lucio.manitta@gmail.com
